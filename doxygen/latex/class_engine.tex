\hypertarget{class_engine}{}\section{Engine Class Reference}
\label{class_engine}\index{Engine@{Engine}}


The engine class captures the settings and uses those to run the simulation functions. The member functions of this class are wrappers for the simulation functions in the \mbox{\hyperlink{class_simulator}{Simulator}} class.  




{\ttfamily \#include $<$Engine.\+h$>$}

\subsection*{Public Member Functions}
\begin{DoxyCompactItemize}
\item 
\mbox{\hyperlink{class_engine_a8b4741a93ca42e6ef32ea49703f9ed70}{Engine}} (std\+::string of, int mt, double sbr, double sdr, double gbr, double gdr, double lgtr, int ipp, int popsize, double gen\+Time, int sd1, int sd2, double treescale, int reps, int num\+Taxa, int nloci, int ngen, double og, bool sout, bool mst)
\begin{DoxyCompactList}\small\item\em Constructor for the engine class. \end{DoxyCompactList}\item 
\mbox{\hyperlink{class_engine_a8ef7030a089ecb30bbfcb9e43094717a}{$\sim$\+Engine}} ()
\begin{DoxyCompactList}\small\item\em Destructor of engine class. \end{DoxyCompactList}\item 
unsigned int \mbox{\hyperlink{class_engine_ad3629de6e2e7b9f0c60c19cc38d9afee}{count\+Newick\+Leaves}} (const std\+::string st\+Newick)
\begin{DoxyCompactList}\small\item\em counts the number of leaves in a Newick string. This is heaveily modified by those used in a tutorial by Paul Lewis (\href{https://phylogeny.uconn.edu/phylogenetic-software-development-tutorial/build-a-tree-from-a-newick-description/}{\texttt{ https\+://phylogeny.\+uconn.\+edu/phylogenetic-\/software-\/development-\/tutorial/build-\/a-\/tree-\/from-\/a-\/newick-\/description/}}) \end{DoxyCompactList}\item 
std\+::string \mbox{\hyperlink{class_engine_a204081a6384298f9804e8048f09a03b0}{strip\+Comments\+From\+Newick\+Tree}} (std\+::string st\+Newick)
\begin{DoxyCompactList}\small\item\em Strips comments from input newick string. \end{DoxyCompactList}\item 
std\+::string \mbox{\hyperlink{class_engine_a34b92fdcc419808389cf55fc387743b6}{format\+Tip\+Names\+From\+Newick\+Tree}} (std\+::string st\+Newick)
\begin{DoxyCompactList}\small\item\em formats the names of tips given in input Newick string files to remove spaces and other tricky characters \end{DoxyCompactList}\item 
\mbox{\Hypertarget{class_engine_af9fe3e8fd1029f641270451453fddf4c}\label{class_engine_af9fe3e8fd1029f641270451453fddf4c}} 
void {\bfseries set\+Input\+Species\+Tree} (const std\+::string st\+Newick)
\item 
\mbox{\Hypertarget{class_engine_a2e29105d50c6ae710f3293a113ac16a4}\label{class_engine_a2e29105d50c6ae710f3293a113ac16a4}} 
std\+::string {\bfseries get\+Input\+Species\+Tree} ()
\item 
void \mbox{\hyperlink{class_engine_a667304a3ace7fdeed09186f1fa35794b}{do\+Run\+Run}} ()
\begin{DoxyCompactList}\small\item\em Function that creates a \mbox{\hyperlink{class_simulator}{Simulator}} class and runs the simulation saving information in the \mbox{\hyperlink{class_tree_info}{Tree\+Info}} class. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{class_engine_ae91f74b568f58b564179882def6b8779}{do\+Run\+Sp\+Tree\+Set}} ()
\begin{DoxyCompactList}\small\item\em Called from do\+Run\+Run if Species tree is read in, simulates a locus tree, then gene trees. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{class_engine_a18d3fc6bf175c803bb7155f9372c16df}{write\+Tree\+Files}} ()
\begin{DoxyCompactList}\small\item\em Writes two species tree files (one with all tips, one with only extant tips. Writes locus trees, writes gene trees. Also, writes a tree file. This function loops through the tree\+Info class with information saved for each simulation and writes that information out. \end{DoxyCompactList}\item 
\mbox{\hyperlink{class_tree_info}{Tree\+Info}} $\ast$ \mbox{\hyperlink{class_engine_a52bf7ab3f2483fd8494311627c278efe}{find\+Tree\+By\+Indx}} (int i)
\begin{DoxyCompactList}\small\item\em Finds a specific species tree (i.\+e. a simulation) within a vector of the \mbox{\hyperlink{class_tree_info}{Tree\+Info}} class and outputs that \mbox{\hyperlink{class_tree_info}{Tree\+Info}} class. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{class_engine_ab7a0c2386843e3671a8df154566733f7}{calc\+Average\+Root\+Age\+Species\+Trees}} ()
\begin{DoxyCompactList}\small\item\em calculates the averages root age of all the saved species trees in the simulation run. This is saved to an outfile \end{DoxyCompactList}\item 
\mbox{\hyperlink{class_species_tree}{Species\+Tree}} $\ast$ \mbox{\hyperlink{class_engine_a0e10774c53dd9d241023ffa2f803d4dd}{build\+Tree\+From\+Newick}} (std\+::string sp\+Tree)
\begin{DoxyCompactList}\small\item\em Converts a Newick tree input into the Species \mbox{\hyperlink{class_tree}{Tree}} class. \end{DoxyCompactList}\end{DoxyCompactItemize}


\subsection{Detailed Description}
The engine class captures the settings and uses those to run the simulation functions. The member functions of this class are wrappers for the simulation functions in the \mbox{\hyperlink{class_simulator}{Simulator}} class. 

\subsection{Constructor \& Destructor Documentation}
\mbox{\Hypertarget{class_engine_a8b4741a93ca42e6ef32ea49703f9ed70}\label{class_engine_a8b4741a93ca42e6ef32ea49703f9ed70}} 
\index{Engine@{Engine}!Engine@{Engine}}
\index{Engine@{Engine}!Engine@{Engine}}
\subsubsection{\texorpdfstring{Engine()}{Engine()}}
{\footnotesize\ttfamily Engine\+::\+Engine (\begin{DoxyParamCaption}\item[{std\+::string}]{of,  }\item[{int}]{mt,  }\item[{double}]{sbr,  }\item[{double}]{sdr,  }\item[{double}]{gbr,  }\item[{double}]{gdr,  }\item[{double}]{lgtr,  }\item[{int}]{ipp,  }\item[{int}]{popsize,  }\item[{double}]{gen\+Time,  }\item[{int}]{sd1,  }\item[{int}]{sd2,  }\item[{double}]{ts,  }\item[{int}]{reps,  }\item[{int}]{ntax,  }\item[{int}]{nloci,  }\item[{int}]{ngen,  }\item[{double}]{og,  }\item[{bool}]{sout,  }\item[{bool}]{mst }\end{DoxyParamCaption})}



Constructor for the engine class. 


\begin{DoxyParams}{Parameters}
{\em of} & string giving the outfile prefix \\
\hline
{\em mt} & integer to be used by a switch to determine which simulation function to run \\
\hline
{\em sbr} & The species birth rate \\
\hline
{\em sdr} & The species death rate \\
\hline
{\em gbr} & The locus tree birth rate \\
\hline
{\em gdr} & The locus tree death rate \\
\hline
{\em lgtr} & The locus tree lateral gene transfer rate \\
\hline
{\em ipp} & Individuals per population (locus tree lineage) to be sampled from multi-\/locus coalescent \\
\hline
{\em popsize} & The total population size across locus tree lineages \\
\hline
{\em gen\+Time} & The gen\+Time is a scaling factor that represents a number of hypothetical generations per unit time to scale coalescent trees by \\
\hline
{\em sd1} & The first R\+NG seed \\
\hline
{\em sd2} & The second R\+NG seed. \\
\hline
{\em ts} & The scaling factor to scale the output species tree to \\
\hline
{\em reps} & Number of replicate species trees (and subsequent tree) to simulate \\
\hline
{\em ntax} & Number of taxa to simulate species tree to \\
\hline
{\em nloci} & Number of locus trees to simulate per species tree \\
\hline
{\em ngen} & Number of gene trees to simulate per gene tree \\
\hline
\end{DoxyParams}
\mbox{\Hypertarget{class_engine_a8ef7030a089ecb30bbfcb9e43094717a}\label{class_engine_a8ef7030a089ecb30bbfcb9e43094717a}} 
\index{Engine@{Engine}!````~Engine@{$\sim$Engine}}
\index{````~Engine@{$\sim$Engine}!Engine@{Engine}}
\subsubsection{\texorpdfstring{$\sim$Engine()}{~Engine()}}
{\footnotesize\ttfamily Engine\+::$\sim$\+Engine (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}



Destructor of engine class. 



\subsection{Member Function Documentation}
\mbox{\Hypertarget{class_engine_a0e10774c53dd9d241023ffa2f803d4dd}\label{class_engine_a0e10774c53dd9d241023ffa2f803d4dd}} 
\index{Engine@{Engine}!buildTreeFromNewick@{buildTreeFromNewick}}
\index{buildTreeFromNewick@{buildTreeFromNewick}!Engine@{Engine}}
\subsubsection{\texorpdfstring{buildTreeFromNewick()}{buildTreeFromNewick()}}
{\footnotesize\ttfamily \mbox{\hyperlink{class_species_tree}{Species\+Tree}} $\ast$ Engine\+::build\+Tree\+From\+Newick (\begin{DoxyParamCaption}\item[{std\+::string}]{sp\+Tree }\end{DoxyParamCaption})}



Converts a Newick tree input into the Species \mbox{\hyperlink{class_tree}{Tree}} class. 


\begin{DoxyParams}{Parameters}
{\em sp\+Tree\+Str} & input Newick string \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Species\+Tree$\ast$ pointer to \mbox{\hyperlink{class_species_tree}{Species\+Tree}} class 
\end{DoxyReturn}
\mbox{\Hypertarget{class_engine_ab7a0c2386843e3671a8df154566733f7}\label{class_engine_ab7a0c2386843e3671a8df154566733f7}} 
\index{Engine@{Engine}!calcAverageRootAgeSpeciesTrees@{calcAverageRootAgeSpeciesTrees}}
\index{calcAverageRootAgeSpeciesTrees@{calcAverageRootAgeSpeciesTrees}!Engine@{Engine}}
\subsubsection{\texorpdfstring{calcAverageRootAgeSpeciesTrees()}{calcAverageRootAgeSpeciesTrees()}}
{\footnotesize\ttfamily void Engine\+::calc\+Average\+Root\+Age\+Species\+Trees (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}



calculates the averages root age of all the saved species trees in the simulation run. This is saved to an outfile 

\begin{DoxyRefDesc}{Todo}
\item[\mbox{\hyperlink{todo__todo000001}{Todo}}]connect this with the stats file output \end{DoxyRefDesc}
\mbox{\Hypertarget{class_engine_ad3629de6e2e7b9f0c60c19cc38d9afee}\label{class_engine_ad3629de6e2e7b9f0c60c19cc38d9afee}} 
\index{Engine@{Engine}!countNewickLeaves@{countNewickLeaves}}
\index{countNewickLeaves@{countNewickLeaves}!Engine@{Engine}}
\subsubsection{\texorpdfstring{countNewickLeaves()}{countNewickLeaves()}}
{\footnotesize\ttfamily unsigned int Engine\+::count\+Newick\+Leaves (\begin{DoxyParamCaption}\item[{const std\+::string}]{sp\+Tree\+Str }\end{DoxyParamCaption})}



counts the number of leaves in a Newick string. This is heaveily modified by those used in a tutorial by Paul Lewis (\href{https://phylogeny.uconn.edu/phylogenetic-software-development-tutorial/build-a-tree-from-a-newick-description/}{\texttt{ https\+://phylogeny.\+uconn.\+edu/phylogenetic-\/software-\/development-\/tutorial/build-\/a-\/tree-\/from-\/a-\/newick-\/description/}}) 


\begin{DoxyParams}{Parameters}
{\em sp\+Tree\+Str} & Newick tree string input by user \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
unsigned int Number of leaves 
\end{DoxyReturn}
\mbox{\Hypertarget{class_engine_a667304a3ace7fdeed09186f1fa35794b}\label{class_engine_a667304a3ace7fdeed09186f1fa35794b}} 
\index{Engine@{Engine}!doRunRun@{doRunRun}}
\index{doRunRun@{doRunRun}!Engine@{Engine}}
\subsubsection{\texorpdfstring{doRunRun()}{doRunRun()}}
{\footnotesize\ttfamily void Engine\+::do\+Run\+Run (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}



Function that creates a \mbox{\hyperlink{class_simulator}{Simulator}} class and runs the simulation saving information in the \mbox{\hyperlink{class_tree_info}{Tree\+Info}} class. 

\mbox{\Hypertarget{class_engine_ae91f74b568f58b564179882def6b8779}\label{class_engine_ae91f74b568f58b564179882def6b8779}} 
\index{Engine@{Engine}!doRunSpTreeSet@{doRunSpTreeSet}}
\index{doRunSpTreeSet@{doRunSpTreeSet}!Engine@{Engine}}
\subsubsection{\texorpdfstring{doRunSpTreeSet()}{doRunSpTreeSet()}}
{\footnotesize\ttfamily void Engine\+::do\+Run\+Sp\+Tree\+Set (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}



Called from do\+Run\+Run if Species tree is read in, simulates a locus tree, then gene trees. 

\mbox{\Hypertarget{class_engine_a52bf7ab3f2483fd8494311627c278efe}\label{class_engine_a52bf7ab3f2483fd8494311627c278efe}} 
\index{Engine@{Engine}!findTreeByIndx@{findTreeByIndx}}
\index{findTreeByIndx@{findTreeByIndx}!Engine@{Engine}}
\subsubsection{\texorpdfstring{findTreeByIndx()}{findTreeByIndx()}}
{\footnotesize\ttfamily \mbox{\hyperlink{class_tree_info}{Tree\+Info}} $\ast$ Engine\+::find\+Tree\+By\+Indx (\begin{DoxyParamCaption}\item[{int}]{i }\end{DoxyParamCaption})}



Finds a specific species tree (i.\+e. a simulation) within a vector of the \mbox{\hyperlink{class_tree_info}{Tree\+Info}} class and outputs that \mbox{\hyperlink{class_tree_info}{Tree\+Info}} class. 


\begin{DoxyParams}{Parameters}
{\em i} & index of the species tree to be found \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
\mbox{\hyperlink{class_tree_info}{Tree\+Info}} class found at index i within a vector of \mbox{\hyperlink{class_tree_info}{Tree\+Info}} class 
\end{DoxyReturn}
\mbox{\Hypertarget{class_engine_a34b92fdcc419808389cf55fc387743b6}\label{class_engine_a34b92fdcc419808389cf55fc387743b6}} 
\index{Engine@{Engine}!formatTipNamesFromNewickTree@{formatTipNamesFromNewickTree}}
\index{formatTipNamesFromNewickTree@{formatTipNamesFromNewickTree}!Engine@{Engine}}
\subsubsection{\texorpdfstring{formatTipNamesFromNewickTree()}{formatTipNamesFromNewickTree()}}
{\footnotesize\ttfamily std\+::string Engine\+::format\+Tip\+Names\+From\+Newick\+Tree (\begin{DoxyParamCaption}\item[{std\+::string}]{sp\+Tree\+Str }\end{DoxyParamCaption})}



formats the names of tips given in input Newick string files to remove spaces and other tricky characters 


\begin{DoxyParams}{Parameters}
{\em sp\+Tree\+Str} & input newick tree\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
std\+::string string with characters removed 
\end{DoxyReturn}
\mbox{\Hypertarget{class_engine_a204081a6384298f9804e8048f09a03b0}\label{class_engine_a204081a6384298f9804e8048f09a03b0}} 
\index{Engine@{Engine}!stripCommentsFromNewickTree@{stripCommentsFromNewickTree}}
\index{stripCommentsFromNewickTree@{stripCommentsFromNewickTree}!Engine@{Engine}}
\subsubsection{\texorpdfstring{stripCommentsFromNewickTree()}{stripCommentsFromNewickTree()}}
{\footnotesize\ttfamily std\+::string Engine\+::strip\+Comments\+From\+Newick\+Tree (\begin{DoxyParamCaption}\item[{std\+::string}]{sp\+Tree\+Str }\end{DoxyParamCaption})}



Strips comments from input newick string. 


\begin{DoxyParams}{Parameters}
{\em sp\+Tree\+Str} & Species tree string input with comments \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
std\+::string Same species tree string stripped of comments 
\end{DoxyReturn}
\mbox{\Hypertarget{class_engine_a18d3fc6bf175c803bb7155f9372c16df}\label{class_engine_a18d3fc6bf175c803bb7155f9372c16df}} 
\index{Engine@{Engine}!writeTreeFiles@{writeTreeFiles}}
\index{writeTreeFiles@{writeTreeFiles}!Engine@{Engine}}
\subsubsection{\texorpdfstring{writeTreeFiles()}{writeTreeFiles()}}
{\footnotesize\ttfamily void Engine\+::write\+Tree\+Files (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}



Writes two species tree files (one with all tips, one with only extant tips. Writes locus trees, writes gene trees. Also, writes a tree file. This function loops through the tree\+Info class with information saved for each simulation and writes that information out. 



The documentation for this class was generated from the following files\+:\begin{DoxyCompactItemize}
\item 
src/Engine.\+h\item 
src/Engine.\+cpp\end{DoxyCompactItemize}
